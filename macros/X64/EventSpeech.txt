EventSpeech Ver.1.2
                            　　　　Copyright(C) misono     2011-2013

１　はじめに
　「EventSpeech」は秀丸リーダーを使わずに秀丸リーダーとほぼ同等の機能を実現します。
　秀丸リーダーはDDE通信というプログラム内部の通信機能を使って秀丸とスクリーンリーダーとの間で文字列のやりとりをしています。一部のPC環境では、このDDE通信がスクリーンリーダー側の動作を不安定にすることがあり、私自身不便を感じていました。また秀丸リーダーは、常に常駐させる必要があり、少しでもメモリに余裕を持たせたいというユーザーとしては若干気になる存在でした。
　そこで作成してみたのがこの「EventSpeech」マクロです。

２　動作環境
　EventSpeechを使用するには、事前に「秀丸エディタもしくは秀丸メール」がインストールされている必要があります。秀まるおのホームページ → http://hide.maruo.co.jp/ 参照のこと。EventSpeechは、今のところPCTalker / NVDA に対応しています。

３　パッケージ内容について
　以下のファイルが含まれています。
(1)EventSpeech.txt            このドキュメント
(2)EventSpeech.mac            マクロ本体
(3)beepms.wav                 文字削除用WAV
(4)KSDMbSp.wav                半角スペース用WAV
(5)KSDSbSp.wav                全角スペース用WAV
(6) MisoSpeech.dll            読み上げようライブラリ
7) nvdaControllerClient64.dll NVDA制御モジュール

４　インストール
　秀丸リーダーの常駐を解除するか、秀丸リーダーをアンインストールしてから次の操作を実行します。秀丸リーダーを解除しないと2重読みが発生します。
　また秀丸メールのエディタ部分を読み上げできるようにする場合も下記と同等の設定が必要な場合があります。適宜お願いします。

(1)パッケージ内のすべてのファイルを秀丸のマクロフォルダにコピーします。パッケージ内のファイルと同じファイル名がコピー先にある場合は上書きします。
(2)秀丸のメニューより「マクロ」→「マクロ登録」で「自動起動」の「自動起動マクロを有効にする」にチェックを入れます。
(3)「編集後タイマー」にチェックを入れます。
(4)マクロ名に「EventSpeech.mac」を登録します。
(5)秒数を 0MS にします。
(6)「カーソル移動後タイマー」にチェックを入れます。
(7)マクロ名に「EventSpeech.mac」を登録します。
(8)秒数を 0MS にします。
(9)「キャッシュファイル( .mac.cache )を自動的に作成して高速化する」にチェックを入れます。（入れなくてもいいですが、キャッシュを作成して高速化が期待できます）

5 NVDAを使用する場合の注意事項
　NVDAを使用する場合には、 add-on フォルダ内に含まれる対応するアドオンをインストールしてください。アドオンのセットアップ方法は NVDA ユーザーガイドをご参照ください。

６　アンインストール
　インストールと逆の手順を行います。

７　使い方
　インストールするとおもむろに読み上げます。

８　制限事項
　カーソル移動後タイマー・編集後タイマーによる動作のため、これらのイベントが発生しなければマクロが動作しないという制約があります。

９　使用条件
・本マクロの著作権は御園 政光にあります。
・本マクロ使用によって生じたいかなる損害についても，作者は一切の責任を負いません。
・このマクロに関するご意見やご要望は以下のメールホームからお問い合わせください。
http://www.043.jp/sendmail/index.html

１０ 転載、再配布
　本マクロを個人で利用する範囲内であれば、自由に改造していただいてかまいません。
　改造したマクロを新たにインターネットで配布する場合には、本マクロの所在も記載してください。
　著作権および本マクロ内に記述されたコードの知的財産権は御園政光にあります。


バージョンアップ履歴

2013/06/24 Ver1.2
・TkSpeechに仕様を合わせた
2012/12/06 Ver1.1
・スクリーンリーダー自動判定機能の追加
・ユニコードへの対応

2012/07/22 Ver1.0
・初版

以上
